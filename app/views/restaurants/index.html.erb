<% if @restaurants.any? %>
  <% @restaurants.each do |restaurant| %>
    <h2><%= link_to restaurant.name, restaurant_path(restaurant) %></h2>
    <%= image_tag restaurant.image.url(:thumb) %>
    <%if restaurant.average_rating == "N/A"%>
      <h3>Average rating: N/A %></h3>
    <%else%>
      <h3>Average rating: <%= "★" * restaurant.average_rating + "☆"* (5-restaurant.average_rating)%></h3>
    <%end%>
    <% if restaurant.belongs_to_user?(current_user)%>

    <%= link_to "Edit #{restaurant.name}", edit_restaurant_path(restaurant) %>

    <%= link_to "Delete #{restaurant.name}", restaurant_path(restaurant), method: :delete %>

    <%end%>
    <% if restaurant.reviews.any? %>
      <% restaurant.reviews.all.each { |review| %>
        Review: <%= review.thoughts %>
        Rating: <%= "★" * review.rating + "☆" * (5-review.rating)%>
        Number of endorsements: <span class='endorsements_count'> <%= review.endorsements.length %> </span>
        <%= link_to "Endorse Review", new_restaurant_review_endorsement_path(restaurant.id,review.id), class: 'endorsements-link' %>
        <% if review.belongs_to?(current_user) %>
        <%= link_to "Delete Your Review", restaurant_review_path(restaurant, review), method: :delete %>
        <% end %>
        <% } %>
    <% end %>
    <% unless current_user && current_user.has_reviewed?(restaurant) %>
      <%= link_to "Review #{restaurant.name}", new_restaurant_review_path(restaurant) %>
    <% end %>

  <% end %>
<% else %>
  <h1>No restaurants yet</h1>
<% end %>

<% if user_signed_in? %>
  <a href="/restaurants/new">Add a restaurant</a>
<% end %>
